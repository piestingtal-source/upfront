define(["jquery","deps/mousetrap","switch.mode"],function($,mousetrap,switchMode){UpFront.contentEditorEditors={};var contentEditorHelper={init:function(){window.onunload=function(){$.each(UpFront.contentEditorEditors,function(index,editor){if(typeof editor.window!="undefined"&&!editor.window.closed){editor.window.close();}});};},showEditor:function(id,blockId,changeCallback){if(typeof UpFront.contentEditorEditors[id]!="undefined"&&!UpFront.contentEditorEditors[id].window.closed){UpFront.contentEditorEditors[id].window.focus();return UpFront.contentEditorEditors[id];}var editorConfig={width:1200,height:780};editorConfig.left=(screen.width/2)-(editorConfig.width/2);editorConfig.top=(screen.height/2)-(editorConfig.height/2);var postId=localStorage["visual-editor-block-post-data-"+blockId+"-0"];UpFront.contentEditorEditors[id]={window:window.open(UpFront.homeURL+"/?upfront-trigger=content-editor&action=edit&post="+postId,id,"width="+editorConfig.width+",height="+editorConfig.height+",top="+editorConfig.top+",left="+editorConfig.left,true)};UpFront.contentEditorEditors[id].window.focus();contentEditorHelper.bindEditor(id,mode,changeCallback);return UpFront.contentEditorEditors[id];},bindEditor:function(id,mode,changeCallback){var window=UpFront.contentEditorEditors[id].window;return $(window).bind("load",function(){mousetrap.bindEventsTo(window.document);if(switchMode.mode()=="true"){themeSelected="night";}window.addEventListener("beforeunload",function(event){return changeCallback();});});}};contentEditorHelper.init();return contentEditorHelper;});